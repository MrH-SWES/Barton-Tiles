<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
  />
  <title>Barton Reading Tile Board — Beta</title>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root{
      --bg: #e5e7eb;
      --ink: #111827;
      --tray: #3f3f46;
      --tab: #6b7280;
      --tab-dim: #9ca3af;
      --tab-ink: #fff;
      --shadow: rgba(0,0,0,.25);
    }

    body{
      font-family: 'Lexend', sans-serif;
      background: var(--bg);
      color: var(--ink);
      height: 100vh;
      overflow: hidden;
      touch-action: manipulation;
    }

    #app{ position: relative; height: 100%; width: 100%; }

    #wordPane{
      position: absolute;
      inset: 0 0 240px 0;
      background: transparent;
      overflow: hidden;
    }

    .hint{
      position: absolute;
      left: 50%;
      top: 46%;
      transform: translate(-50%,-50%);
      color: #6b7280;
      font-size: 18px;
      text-align: center;
      pointer-events: none;
    }

    .tile{
      width: 60px;
      height: 60px;
      border: 2px solid #374151;
      border-radius: 6px;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      user-select: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.25);
      flex-shrink: 0;
      touch-action: none;
      background: white;
    }
    .tile:active{ cursor: grabbing; }
    .tile.blue   { background-color: #60a5fa; }
    .tile.yellow { background-color: #fbbf24; }
    .tile.red    { background-color: #f87171; }
    .tile.green  { background-color: #4ade80; }
    .tile.orange { background-color: #fb923c; }
    .tile.purple { background-color: #a78bfa; }

    .tile.dragging{
      position: fixed;
      z-index: 1000;
      opacity: .95;
      pointer-events: none;
      will-change: transform;
      left: 0; top: 0;
    }

    .word-pane-tile{ position: absolute; }

    #controls{
      position: absolute;
      top: 12px;
      left: 12px;
      display: flex;
      gap: 8px;
      z-index: 10;
    }
    .btn{
      background: #111827;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: 700;
      box-shadow: 0 2px 6px var(--shadow);
    }
    .btn.secondary{ background: #374151; }
    .btn.danger{ background: #dc2626; }

    /* fixed bottom trays */
    #bottomDock{
      position: absolute;
      left: 0; right: 0; bottom: 0;
      height: 240px;
      pointer-events: none;
      z-index: 20;
    }

    .drawerRow{
      position: absolute;
      left: 0; right: 0; bottom: 0;
      display: flex;
      gap: 10px;
      padding: 10px 14px;
      justify-content: flex-start;
      pointer-events: auto;
    }

    .drawer{
      position: relative;
      flex: 0 0 140px;
      width: 140px;
    }
    .drawer .tab{ width: 140px; }

    .drawer.active{
      flex: 1 1 auto;
      width: 100%;
    }

    .tab{
      position: absolute;
      left: 0; right: 0; bottom: 0;
      height: 40px;
      background: var(--tab);
      border-radius: 10px 10px 0 0;
      color: var(--tab-ink);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      letter-spacing: .2px;
      box-shadow: 0 -2px 6px rgba(0,0,0,.2), 0 3px 8px var(--shadow);
      cursor: pointer;
      user-select: none;
      z-index: 2;
    }
    .tab.dim{ background: var(--tab-dim); }

    .drawerContent{
      position: absolute;
      left: 0; right: 0;
      bottom: 40px;
      background: var(--tray);
      border-radius: 12px 12px 0 0;
      padding: 10px 12px;
      box-shadow: 0 -6px 12px rgba(0,0,0,.35);
      overflow: hidden;
      transform: translateY(100%);
      max-height: 0;
      transition: transform .25s ease, max-height .25s ease;
      z-index: 3;
    }
    .drawer.open .drawerContent{
      transform: translateY(0%);
      max-height: 320px;
      overflow: visible;
    }

    .tile-row{
      display: flex;
      flex-wrap: nowrap;
      gap: 8px;
      justify-content: flex-start;
      overflow-x: auto;
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 6px;
    }
    .tile{ flex: 0 0 auto; }

    .legend{ color: #e5e7eb; font-size: 12px; margin: 4px 0 8px; text-align: center; }
  </style>
</head>
<body>
  <div id="app">
    <div id="wordPane">
      <div class="hint">Drag tiles here to build words.</div>
      <div id="controls">
        <select id="lessonSelect" class="btn secondary">
          <option value="2">Book 2</option>
          <option value="3">Book 3</option>
          <option value="4">Book 4</option>
          <option value="5">Book 5</option>
          <option value="6">Book 6</option>
          <option value="7">Book 7</option>
          <option value="8">Book 8</option>
          <option value="9">Book 9</option>
          <option value="10">Book 10</option>
        </select>
        <button id="resetButton" class="btn danger">Reset</button>
      </div>
    </div>

    <div id="bottomDock">
      <div class="drawerRow">
        <div class="drawer" id="drawer-alphabet">
          <div class="tab">Basic Tiles</div>
          <div class="drawerContent">
            <div class="legend">A–Z and graphemes</div>
            <div class="tile-row" id="lessonTiles"></div>
          </div>
        </div>
        <div class="drawer" id="drawer-units">
          <div class="tab dim">Units</div>
          <div class="drawerContent">
            <div class="tile-row" id="wordUnits"></div>
          </div>
        </div>
        <div class="drawer" id="drawer-affixes">
          <div class="tab dim">Suffixes / Prefixes</div>
          <div class="drawerContent">
            <div class="tile-row" id="affixes"></div>
            <div class="tile-row" id="prefixes" style="margin-top:10px;"></div>
          </div>
        </div>
        <div class="drawer" id="drawer-roots">
          <div class="tab dim">Greek / Latin Roots</div>
          <div class="drawerContent">
            <div class="tile-row" id="latin"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // simplified data, snapping logic retained
    const TILE_SIZE = 60;
    const B_LEVELS = {
      2: { blue:["b","c","d","f","g","h","j","k","l","m","n","p","qu","r","s","t","v","w","x","y","z","ch","ck","sh","th","wh"], yellow:["a","e","i","o","u"] },
      3: { red:["all","ang","ing","ong","ung","ank","ink","onk","unk","oll","old","olt","ost","ild","ind"] },
      4: { yellow:["ai","ay","ee","oa","oe","ue","ew","ow"] },
      5: { green:["s","es","ed","ing","er","est","ist","y","en","ish","ity","able","tion","sion"], orange:["dis","in","un","non","mis","sub","re","pre","inter","mid","over","up"] },
      6: { blue:["ph"], yellow:["y"], red:["ture"], green:["ible","ble","cle","dle","fle","gle","kle","ple","tle","zle"], orange:["ate","ite","ine","ice","ace","age"] },
      7: { yellow:["ar","or","er","ir","ur","ear"], green:["ary","ery","ory"] },
      8: { yellow:["ie","oi","oy","ey","au","aw","oo","ou","ow","ea","igh","augh","eigh","ei","eu","tu"] },
      9: { blue:["ps","rh","mn","wr","kn","gh","gn","que","gu","gue"], yellow:["eau","our"], orange:["age"] },
      10:{ purple:["astro","auto","bio","chron","geo","graph","hydro","phon","tele","demo","fac","form","fort","fract","ject","jud","mal","mater","mit","mort","multi","pater","port","rupt","scrib","script","sect","sec","sent","spect","struct"] }
    };
    let tiles=[];
    function getFontSize(t){return t.length<=2?'24px':t.length<=3?'20px':t.length<=4?'16px':'14px';}
    function setupDrawers(){
      const drawers=document.querySelectorAll('.drawer');
      drawers.forEach(d=>{
        d.querySelector('.tab').addEventListener('click',()=>{
          drawers.forEach(x=>x.classList.remove('open','active'));
          d.classList.add('open','active');
        });
      });
      drawers[0].classList.add('open','active');
    }
    function renderTray(){
      const lvl=parseInt(document.getElementById('lessonSelect').value);
      const blue=[], yellow=[], red=[], green=[], orange=[], purple=[];
      for(let i=2;i<=lvl;i++){const L=B_LEVELS[i];if(!L)continue;
        if(L.blue)blue.push(...L.blue); if(L.yellow)yellow.push(...L.yellow);
        if(L.red)red.push(...L.red); if(L.green)green.push(...L.green);
        if(L.orange)orange.push(...L.orange); if(L.purple)purple.push(...L.purple);
      }
      const mk=(id,arr,col)=>{const el=document.getElementById(id);el.innerHTML='';arr.forEach(t=>{const d=document.createElement('div');d.className='tile '+col;d.textContent=t;d.style.fontSize=getFontSize(t);el.appendChild(d);});};
      mk('lessonTiles',[...blue,...yellow],'blue');
      mk('wordUnits',red,'red');
      mk('affixes',green,'green');
      mk('prefixes',orange,'orange');
      mk('latin',purple,'purple');
    }
    document.getElementById('lessonSelect').addEventListener('change',renderTray);
    document.getElementById('resetButton').addEventListener('click',()=>{tiles=[];document.querySelector('.hint').style.display='block';});
    setupDrawers(); renderTray();
  </script>
</body>
</html>
